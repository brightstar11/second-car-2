<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<meta charset="UTF-8" />
<div th:include="common/head"></div>
<body class="">

	<div class="page-main">
		<div class="header py-4">
			<div class="container">
				<div class="d-flex">
					<a class="header-brand" href="./index.html"> <img
						th:src="@{${application.logo}}" class="header-brand-img" /> <span
						th:text="${application.title}"></span>
					</a>
					<div class="d-flex order-lg-2 ml-auto">
						<div class="dropdown d-none d-md-flex">
							<a class="nav-link icon" data-toggle="dropdown"> <i
								class="fe fe-bell"></i> <span class="nav-unread"></span>
							</a>

						</div>
						<div class="dropdown">
							<a href="#" class="nav-link pr-0 leading-none"
								data-toggle="dropdown"> 
								<span class="ml-2 d-none d-lg-block"> <span
									class="text-default" th:text="${session.LOGIN_KEY.adminName}"></span>
									<small class="text-muted d-block mt-1"
									th:text="${session.LOGIN_KEY.adminName}"></small>
							</span>
							</a>
							<div
								class="dropdown-menu dropdown-menu-right dropdown-menu-arrow">
								
								<div class="dropdown-divider"></div>
								<button class="dropdown-item"  onclick="help()"> <i
									class="dropdown-icon fe fe-help-circle"></i> 帮助?
								</button> <a class="dropdown-item" href="/WebCar/admin/logout"> <i
									class="dropdown-icon fe fe-log-out"></i> 退出
								</a>
							</div>
						</div>
					</div>
					<a href="#" class="header-toggler d-lg-none ml-3 ml-lg-0"
						data-toggle="collapse" data-target="#headerMenuCollapse"> <span
						class="header-toggler-icon"></span>
					</a>
				</div>
			</div>
		</div>
		<div class="header collapse d-lg-flex p-0" id="headerMenuCollapse">
			<div class="container">
				<div class="row align-items-center">
					<div class="col-lg-3 ml-auto">
						<form class="input-icon my-3 my-lg-0">

							<div class="input-icon-addon"></div>
						</form>
					</div>
					<div class="col-lg order-lg-first">
						<ul class="nav nav-tabs border-0 flex-column flex-lg-row">
							<li class="nav-item"
								th:each="menu,menuStat:${session.LOGIN_KEY.adminMenus}">
								<div th:if="${menu.menus.size() == 0}">
									<a th:text="${menu.menuName}" th:href="${menu.menuUrl}"
										class="nav-link"> <i th:class="${menu.menuIcon}"></i>
									</a>
									<div class="dropdown-menu dropdown-menu-arrow"
										th:if="${menu.menus.size()!=0}">
										<a th:href="${m2.menuUrl}" class="dropdown-item "
											th:each="m2,m2Stat:${menu.adminMenus}"
											th:text="${m2.menuName}"> </a>
									</div>
								</div>
								<div th:unless="${menu.menus.size() == 0}">
									<a th:text="${menu.menuName}" th:href="${menu.menuUrl}"
										class="nav-link" data-toggle="dropdown"> <i
										th:class="${menu.menuIcon}"></i>
									</a>
									<div class="dropdown-menu dropdown-menu-arrow"
										th:if="${menu.menus.size()!=0}">
										<a th:href="${m2.menuUrl}" class="dropdown-item "
											th:each="m2,m2Stat:${menu.menus}" th:text="${m2.menuName}">
										</a>
									</div>
								</div>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<!-- 首页内容 -->
		<!-- 表格开始 -->
		<div class="my-3 my-md-5">
			<!-- 首页展示 -->
			<div class="card-header">
				<h3 class="card-title">车辆管理页面</h3>
				<div class="col-lg-3 ml-auto">
					<form class="input-icon my-3 my-lg-0"
						th:action="@{/WebCar/admin/searchCarName}" method="get">
						<input type="text" name="name" class="form-control header-search"
							placeholder="输入汽车品牌..." tabindex="1" />
					</form>
				</div>
			</div>
			<div class="table-responsive">
				<table class="table card-table table-vcenter text-nowrap">
					<thead>
						<tr>
						     
							<td>汽车品牌</td>
							<td>汽车名称</td>
							<td>汽车车型</td>
							<td>上牌地点</td>
							<td>上牌时间</td>
							<td>生产时间</td>
							<td>汽车版本</td>
							<td>行驶里程</td>
							<td>排量</td>
							<td>发动机型号</td>
							<td>驱动方式</td>
							<td>油耗</td>
							<td>汽车长</td>
							<td>汽车宽</td>
							<td>汽车高</td>
							<td>汽车级别</td>
							<td>后备箱容积</td>
							<td>驾驶方式</td>
							<td>价格</td>
							<td>车架号</td>
							<td>颜色</td>
							<td>使用能源类型</td>
							<td>产地</td>
							<td>生产方式</td>
							
							<td>汽车图片</td>
							<td>是否通过验证</td>
							<td>汽车拥有人名字</td>
							
							<td>你可以进行的操作</td>
						</tr>
					</thead>
					<tbody th:each="p:${list}">
						<tr>
						    <td th:text="${p.id}" style="display:none"></td>
                            <td th:text="${p.brandname}"></td>
							<td th:text="${p.carname}"></td>
							<td th:text="${p.cartype}"></td>
							<td th:text="${p.carlnwhere}"></td>
							<td th:text="${p.carlntime}"></td>
							<td th:text="${p.carbirth}"></td>
							<td th:text="${p.caredition}"></td>
							<td th:text="${p.carmileage}"></td>
							<td th:text="${p.cardisplacement}"></td>
							<td th:text="${p.carmotor}"></td>
							<td th:text="${p.cardrive}"></td>
							<td th:text="${p.caroil}"></td>
							<td th:text="${p.carlong}"></td> 
							<td th:text="${p.carwide}"></td> 
							<td th:text="${p.carheight}"></td>
							<td th:text="${p.levelname}"></td>
							<td th:text="${p.cartrunk}"></td>
							<td th:text="${p.drivetype}"></td>
							<td th:text="${p.carprice}"></td>
							<td th:text="${p.carno}"></td>
							<td th:text="${p.carcolor}"></td>
							<td th:text="${p.carpower}"></td>
							<td th:text="${p.carpop}"></td>
							<td th:text="${p.carpmethod}"></td>
							<td th:text="${p.caricon}"></td>
							<td th:text="${p.carvalidate}"></td>
							<td th:text="${p.carhavename}"></td>
							
							<td><input type="button" value="修改汽车验证状态" name="button"
								th:onclick="'openwin(\''+${p.id}+'\')'" class="EVA12"/> 
								<input
								type="button" value="删除汽车" name="button2" th:onclick="'deletea(\''+${p.id}+'\')'" class="EVA13"/>
								<button data-toggle="modal" data-target="#myModal"  class="EVA11"  style="display:none" th:onclick="'EAV(\''+${p.id}+'\')'">车辆审核分配</button>
								<input
								type="button" value="资料补充" name="button2" th:onclick="'adda(\''+${p.id}+'\')'" class="EVA14" style="display:none"/>
								</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div th:include="common/common::page"></div>
		<!-- 表格结束 -->



	</div>



	<div class="col-6 col-md-3">


		<footer class="footer">
			<div class="container">
				<div class="row align-items-center flex-row-reverse">
					<div class="col-auto ml-lg-auto">
						<div class="row align-items-center">
							<div class="col-auto">
								<ul class="list-inline list-inline-dots mb-0">

								</ul>
							</div>

						</div>
					</div>
					<p th:text="${session.LOGIN_KEY.adminPermission}" hidden="hidden" id="p111">
					<div class="col-12 col-lg-auto mt-3 mt-lg-0 text-center">
						Copyright © 2018</div>
				</div>
			</div>
		</footer>
	</div>
</body>
<!-- 模态框（Modal） -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
<h4 class="modal-title" id="myModalLabel">选择审核人员</h4>
</div>

<div class="modal-body">
<input type="hidden" value="" name="carid" id="carid"  />
<center>
 <div class="bs-example" data-example-id="hoverable-table">
                                <table class="table table-hover" id="btable" >
                                    <thead>
                                    <tr>
 
                                       
                                        <th>姓名</th>
                                        <th>电话</th>
                                        <th>所在地</th>
                                         <th>选择</th>
                                    </tr>
                                    </thead>
                                    <tbody id="tableble" th:each="p:${list2}">
 
                                    <tr id="1" >
                                    <td th:text="${p.adminId}" style="display:none">
                                    <td th:text="${p.realName}"></td>
                                    <td th:text="${p.adminPhone}"></td>
                                    <td th:text="${p.adminaddress}"></td>
                                    <td ><button type="button" class="btn btn-primary" th:onclick="'EVAsubmit(\''+${p.adminId}+'\')'">选择</button></td>
                                    </tr>
                                    </tbody>
                                </table>
 
                            </div>

</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>

</div>
</div><!-- /.modal-content -->
</div><!-- /.modal -->
</div>
<script type="text/javascript">
function help(){
	var obj = document.getElementById("p111");
	 if(obj.innerHTML==3){
	    	alert("销售经理，主要负责: 1.对于订单的分配  2.对于销售人员的管理  3.对于车辆的管理");
	    }if(obj.innerHTML==4){
	    	alert("销售人员，主要负责：1.对于分配到自己的订单处理  2.对于分配到自己的车辆的处理");
	    }
	}
function deletea(id){
	
		var id=id;
		var data='id='+id;
		$.ajax({
			 type: "POST",//方法类型
		     url: "/WebCar/admin/Admin_CarManageDelect" ,//url
		     data:data,
		     success: function (reslut) {
		         
		         console.log(reslut);//打印服务端返回的数据(调试用)
		         if (reslut=='1') {
		         	alert("删除成功");
		         	window.location.href = "/Webcar/admin/admin_CarManageupdateSuccess";
		         };
		     },
		     error : function() {
		         alert("异常！");
		         window.location.href = "/Webcar/admin/admin_CarManageupdateError";
		     }
		});
	} 
function openwin(id){
	
	var id=id;
	var data='id='+id;
	$.ajax({
		 type: "POST",//方法类型
	     url: "/WebCar/admin/Admin_CarManageUpdate" ,//url
	     data:data,
	     success: function (reslut) {
	         
	         console.log(reslut);//打印服务端返回的数据(调试用)
	         if (reslut=='1') {
	         	alert("修改成功");
	         	window.location.reload();
	         };
	     },
	     error : function() {
	         alert("异常！");
	         
	     }
	});
} 
function EAV(id){
	
	$('#myModal').modal().show();
	var orderName =$('#carid').val(id)
}
function EVAsubmit(id){
	var carid=$('#carid').val();
	var sellpeopleid=id;
	
	$.ajax({
		 type: "POST",//方法类型
	     url: "/WebCar/admin/car_sellpeopleAdd" ,//url
	     data:{
	    	 carid:carid,
	    	 sellpeopleid:sellpeopleid
	     },
	     success: function (reslut) {
	         
	         console.log(reslut);//打印服务端返回的数据(调试用)
	         if (reslut=='1') {
	         	alert("车辆审核分配成功");
	         	window.location.href = "/WebCar/admin/Car_Sellpeoplecarallocation";
	         }else{
	        	 alert("车辆审核分配失败");
	         };
	         
	     },
	     error : function() {
	         alert("异常！");
	        
	     }
	});
	$('#myModal').modal().hide();
}
window.onload=function(){
	var url = window.location.href;
	if(url=="http://localhost:8888/WebCar/admin/Car_Sellpeoplecarallocation"){
		$(".EVA11").show();
		$(".EVA12").hide();
		$(".EVA13").hide();
	}if(url=="http://localhost:8888/WebCar/admin/Car_look"||url=="http://localhost:8888/WebCar/admin/Car_look2"){
		
		$(".EVA14").show();
	}
	
	
	
}

function adda(id){
	var id=id;
}
</script>

</html>